---
layout: post
title: "媒体文件格式分析之FLV"
date: 2016-07-24 00:22:21 -0700
comments: true
categories: 总结积累
---

[FLV](https://en.wikipedia.org/wiki/Flash_Video) 是 FLASH VIDEO 的简称，FLV 流媒体是随着Flash MX 的推出发展而来的视频格式。FLV 一般由文件头(FLV header) 和文件体(FLV body) 组成。其中文件体(FLV body)由一些列tag组成，tag又可分成三类:audio/video/script，分别代表音频流、视频流、脚本流(关键字或文件信息之类)。
<!--more-->
在 FLV 文件中，每种 tag 类型都由一个单独的流组成，即在 FLV 文件中最多有一个视频流和一个音频流，对同一种类型的流，FLV 中不能够定义多个独立的流。
与 SWF 文件不同,FLV 文件以大字节序存储多字节。比如，0x300(0x12C) 在 SWF 文件中的字节序为 0x2C 0x01,在FLV 文件中则为 0x01 0x2C。

## FLV Header
以 FLV Header `46 4C 56 01 05 00 00 00 09`为例：
<img src="/images/flvparse/flv_header.png">
FLV Header 的前三个字节是固定的`FLV`的 ASCII 码的值`0x46 0x4C 0x56`; 接下来的一个字节表示 FLV 的版本号,例如 0x01 代表 FLV 版本号为 1。第 5 个字节中的第0位和第2位分别表示video和audio的存在情况（1表示存在，0表示不存在）,其余6位必须为0.最后的4字节表示FLV Header的长度，对于version 1，此处为9.
## FLV File Body
## FLV tags
### Audio tags
### Video tags

