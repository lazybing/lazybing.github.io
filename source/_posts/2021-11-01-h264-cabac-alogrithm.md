---
layout: post
title: "H264 CABAC Alogrithm"
date: 2021-11-01 16:25:07 -0800
comments: true
categories: x264
---

* list element with functor item
{:toc}

基于上下文的自适应二进制算术编码(CABAC)是 ITU-T/ISO/IEC 视频压缩标准 H.264/AVC 的一个标准部分。通过将自适应二进制算术编码技术与上下文建模相结合，实现了高度的自适应并降低冗余。CABAC 框架还包括一种用于用于二进制算术编码和概率估计的新的低复杂度方法，非常适合高效的硬件和软件实现。对于预期目标应用的典型领域，CABAC 显著优于H.264/AVC的 baseline 熵编码方法。对于代表广播应用中使用的典型材料的一组测试序列，以及大约30到38 dB 的可接受视频质量范围，平均比特流节省9%-14%。

<!--more-->

## CABAC 框图

{% img /images/h264_cabac/h264_cabac.png %}

图1显示了在 CABAC 中编码单个语法元素的通用框图。编码过程最多由三个基本步骤组成：1) 二值化 2）上下文建模 3）二进制算术编码  

第一步中，将给定的非二进制值语法元素唯一地映射到二进制序列，即所谓的 bin string。当给定一个二进制语法元素时，这个初始步骤被忽略，如图 1 所示。对于 bin string 的每个元素或每个二进制语法元素，根据编码模式可能会遵循一个或两个后续步骤。  

在所谓的常规编码模式中，在实际算术编码过程之前，给定的二进制决策(在下文中，我们称之为bin)进入上下文建模阶段，在此阶段选择概率模型，以便相应的选择可能取决于先前编码的语法元素或bin。然后，在分配上下文模型之后，bin 值及其相关模型被传递到常规编码引擎，在该引擎中进行算术编码的最后阶段以及随后的模型更新(参见图1)。  

或者，为所选择的bins选择 bypass编码模式，以便通过简化的编码引擎而不使用明确分配的模型来允许整个编码(和解码)过程的加速，如图1中开关的右下分支所示。  

接下来，将更详细地讨论三个主要功能构建块，即二值化、上下文建模和二值算术编码，以及它们之间的相互依赖关系。  

### A. 二值化

1) 普通方法：为了在视频编码中成功应用上下文建模和自适应算术编码，我们发现应满足以下两个要求：  

a) 条件概率的快速和准确估计，必须在 slice 编码单元的相对较短的时间间隔内实现。  
b) 执行概率估计和后续算术编码的每个基本操作所涉及的计算复杂度，必须保持在最低水平，以促进这些固有的顺序组织过程的足够高的吞吐量。

为了满足这两个要求，我们引入了重要的"预处理"步骤，即首先减少要编码的语法元素的字母表大小。CABAC 中的字母表缩减是通过对每个非二进制语法元素应用二值化方案来执行的，从而给定语法元素生成唯一的中间二进制码字，称为二进制字符串。这种方法的优点在于建模和实现。  

首先，重要的是要注意，在建模方面没有任何损失，因为可以通过使用 bin 字符串的各个 bin 的概率来恢复单个(非二进制)符号概率。为了说明这一点，让我们考虑P/SP slice的语法元素mb_type的二值化。  



CABAC(Context-Based Adaptive Binary Arithmetic Coding) 主要包括三步：二值化、上下文建模、二进制算术编码。

